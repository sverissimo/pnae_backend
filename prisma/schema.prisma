generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Produtor {
  id             Int           @id @map("id_pessoa_demeter")
  nome           String        @map("nm_pessoa")
  cpfCnpj        String        @unique @map("nr_cpf_cnpj")
  tipoPessoa     TipoPessoa    @map("tp_pessoa")
  sexo           TipoSexo?     @map("tp_sexo")
  dataNascimento String?       @map("dt_nascimento")
  situacao       Int           @map("sn_ativo")
  caf            String?
  dap            String?
  municipioId    Int?          @map("id_municipio")
  propriedades   Propriedade[]
  relatorios     Relatorio[]
}

model Propriedade {
  id              Int       @id
  produtorId      Int       @map("produtor_id")
  nomePropriedade String    @map("nome_propriedade")
  coordenadas     String?   @map("geo_ponto_texto")
  area            String?   @map("area_total")
  municipioId     Int?      @map("id_municipio")
  produtor        Produtor? @relation(fields: [produtorId], references: [id])
}

model Relatorio {
  id              Int           @id @default(autoincrement())
  numeroRelatorio Int           @map("nr_relatorio")
  assunto         String
  orientacao      String
  produtor        Produtor?     @relation(fields: [produtorId], references: [id])
  produtorId      Int           @map("produtor_id")
  files           PictureFile[]
  createdAt       DateTime?     @default(now()) @map("created_at")
}

model PictureFile {
  id          String             @id @default(uuid())
  fileName    String
  size        Float
  mimeType    String
  description PictureDescription
  relatorio   Relatorio?         @relation(fields: [relatorioId], references: [id])
  relatorioId Int                @map("relatorio_id")
  updloadDate DateTime?          @default(now()) @map("upload_date")
}

model Tecnico {
  id   Int    @id @default(autoincrement())
  nome String
  cpf  String
  masp String
}

enum TipoPessoa {
  F
  J
}

enum TipoSexo {
  F
  M
}

enum PictureDescription {
  FOTO_RELATORIO
  ASSINATURA_PRODUTOR
}

enum Sexo {
  MASCULINO
  FEMININO
  NAO_INFORMADO
}
